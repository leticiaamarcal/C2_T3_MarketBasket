#library
library(dplyr)
library(readr)

#upload data
msleep <- read.csv("C:/Users/letic/Downloads/msleep_ggplot2.csv")

# Select the name column and all columns starting with "sl"
msleep %>% select(name)

msleep %>% select(starts_with("sl"))

msleep %>% select(name, starts_with("sl"))

# Let's take a look at the average sleep time of the animals according to their eating habits.
# Create a new datafame with two columns: "vore" and "mean_sleep"
msleep %>% group_by(vore) %>% 
           summarise(mean_sleep = mean(sleep_total)) -> newDF


# Build again the same df, but this time we want to exclude animals that sleep less than 2 hours or more than 19

msleep %>% group_by(vore) %>% 
  filter(sleep_total >= 2, sleep_total <= 19) %>% 
  summarise(mean_sleep = mean(sleep_total)) -> newDF2


# Same df as before, but don't want domesticated animals in our table
msleep$conservation <- as.character(msleep$conservation)

msleep %>% filter(sleep_total >= 2, sleep_total <= 19, 
                  conservation != "domesticated")%>% 
  group_by(vore) %>% 
  summarise(mean_sleep = mean(sleep_total)) -> newDF3

# We don't want NAs in vore, and we also don't want domesticated animals
msleep %>% filter(sleep_total >= 2, sleep_total <= 19, 
                  conservation != "domesticated",
                  !is.na(vore),
                  !is.na(conservation))%>% 
  group_by(vore) %>% 
  summarise(mean_sleep = mean(sleep_total)) -> newDF4

# We want to add a column with their brain-to-body mass ratio

msleep %>% 
  filter(sleep_total >= 2, sleep_total <= 19, 
                  conservation != "domesticated",
                  !is.na(vore),
                  !is.na(conservation))%>% 
  mutate(mass_ratio = brainwt/bodywt) %>% 
  group_by(vore) %>% 
  summarise(mean_sleep = mean(sleep_total), 
            mean_mass_ratio = mean(mass_ratio)) -> newDF5

# We want to add a column with the count for each row
msleep %>% 
  filter(sleep_total >= 2, sleep_total <= 19, 
         conservation != "domesticated",
         !is.na(vore),
         !is.na(conservation))%>% 
  mutate(mass_ratio = brainwt/bodywt)%>% 
  group_by(vore) %>% 
  summarise(mean_sleep = mean(sleep_total), 
            mean_mass_ratio = mean(mass_ratio),
            numberRows = n()) -> newDF6


# Order your df by the count column in descending order

msleep %>% 
  filter(sleep_total >= 2, sleep_total <= 19, 
         conservation != "domesticated",
         !is.na(vore),
         !is.na(conservation))%>% 
  mutate(mass_ratio = brainwt/bodywt)%>% 
  group_by(vore) %>% 
  summarise(mean_sleep = mean(sleep_total), 
            mean_mass_ratio = mean(mass_ratio),
            numberRows = n()) %>%  
            arrange(desc(numberRows)) -> newDF7


